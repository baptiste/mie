clearvars
close all

nNmax=1;

lambda=633.0;  

Ca={30.0,35.0,36,37};
Cepsilon={1.5^2, (0.093284+4.01686i)^2, (1.5+2i)^2, 1.2^2, 1.0};


stMieRes=mie_FF(lambda,Cepsilon,Ca,nNmax);

Qext = stMieRes.Qext; 
Qsca = stMieRes.Qsca; 
Qabs = stMieRes.Qabs; 

[Qext, Qsca, Qabs] * pi*37^2

Gamma = [];
Delta = [];
A = [];
B = [];
% 
% alpha = [];
% beta = [];
% delta = [];
% gamma = [];
format long
for i=1:4 
    Gamma(i) = stMieRes.CstMulGDAB{i}.Gamma;
    Delta(i) = stMieRes.CstMulGDAB{i}.Delta;
    A(i) = stMieRes.CstMulGDAB{i}.A;
    B(i) = stMieRes.CstMulGDAB{i}.B;
end

    alpha = stMieRes.Calphakn1;
    beta = stMieRes.Cbetakn1;
    delta = stMieRes.Cdeltakn1;
    gamma = stMieRes.Cgammakn1;

% 
% a[0.168261-0.084946im 0.168261-0.084946im 0.168261-0.084946im 0.168261-0.084946im]
% b[0.000160769+0.00117674im 0.000160769+0.00117674im 0.000160769+0.00117674im 0.000160769+0.00117674im]
% ab[-0.000473774+0.0443527im -0.15589+0.00189087im -0.0932682+0.0623298im -4.78749e-5+0.0595091im]
% bb[0.379032-0.125689im -1.6492+0.628848im -0.284844+0.911809im 0.0739356+0.0336902im]
% cb[0.0+0.0im -0.00786401+0.000299627im 0.00594666+0.00190912im -0.000416414-0.00427208im]
% db[0.0-0.0im 1.16117-0.420747im -0.200759-0.630723im -0.543771+0.242391im]
% 
%     Gamma: -1.2515e-04 - 9.1082e-04i
%         A: 0.8427 + 0.0005i
%     Delta: -0.1394 + 0.0813i
%         B: 0.4067 - 1.0094i
        

% a 0.168261-0.084946im
% b 0.000160769+0.00117674im

% G: 0.0857 - 0.0107i  -0.0031 + 0.0137i  -0.0002 - 0.0016i  -0.0001 - 0.0009i
% D: -1.2976 + 0.1054i   0.1856 + 0.0555i  -0.1539 - 0.1239i  -0.1394 + 0.0813i



% Qext
% x = 2*pi/lambda * 37;
% 3 * real(Gamma(4) + Delta(4)) * 2 / x^2

% 1i*B
%  -3.416736760533523 + 0.110234222177277i  0.322406903128560 + 0.362521595460327i  0.317947288103144 + 0.307265269808129i
%  -0.000518952010422 + 0.842737711895827i
% [0.0+0.0im -0.00663398+0.000265193im 0.00493512+0.00150725im -0.000354125-0.00345733im]

% abar -0.000394028+0.0402833im -0.141903+0.00184297im -0.084055+0.0567902im -3.29508e-5+0.0535095im

    [-0.0134496+1.37502im -4.61722+0.0538552im -3.03755+1.88701im 0.0109628+1.94448im; 
    -0.00991312+1.01347im -3.40315+0.0396944im -2.23885+1.39083im 0.00808024+1.4332im; 
    -0.00937662+0.958617im -3.21898+0.0375461im -2.11768+1.31556im 0.00764294+1.35563im; 
    -0.00888303+0.908155im -3.04953+0.0355697im -2.00621+1.24631im 0.00724061+1.28427im]


    [-1.897119214547627 - 0.018556486468171i]    [-0.023320593399123 + 0.554490620687363i]
    [-0.795459571416433 + 0.822099889868863i]    [-2.587188025130138 - 0.001593172357222i]    [-3.069980123839466]


